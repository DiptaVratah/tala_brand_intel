---
phase: 02-interface-differentiation
plan: 04
type: execute
wave: 2
depends_on: ["02-01", "02-02"]
files_modified:
  - pulsecraft_ui/shapeshifter.js
  - pulsecraft_ui/style.css
  - pulsecraft_ui/index.html
autonomous: true

must_haves:
  truths:
    - "Mode switcher dropdown shows color-coded options"
    - "Current mode is clearly indicated with its accent color"
    - "Empty state shows mode-specific welcome message before first kit"
    - "Typography feels professional (Branding), creative (Author), or supportive (Self-Reflection)"
    - "Placeholder text in input adapts per mode"
  artifacts:
    - path: "pulsecraft_ui/style.css"
      provides: "Mode switcher styling, empty state styling, typography differentiation"
      contains: ".mode-switcher"
    - path: "pulsecraft_ui/shapeshifter.js"
      provides: "setupModeSwitcher with color coding"
      contains: "mode-option"
    - path: "pulsecraft_ui/index.html"
      provides: "Empty state container element"
      contains: "empty-state"
  key_links:
    - from: "mode-switcher select"
      to: "shapeshifter.setMode()"
      via: "change event"
      pattern: "addEventListener\\(['\"]change['\"]"
---

<objective>
Redesign mode switcher with color-coded options, add empty state components, and implement subtle typography differentiation.

Purpose: Implements UI-04 (mode switching clarity), UI-07 (placeholder text), UI-08 (spacing/typography), and empty state requirements from CONTEXT.md. Visual distinction helps users understand which mode they're in.

Output: Color-coded mode switcher, empty state component for Voice Library, typography CSS rules per mode.
</objective>

<execution_context>
@/Users/dipta/.claude/get-shit-done/workflows/execute-plan.md
@/Users/dipta/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-interface-differentiation/02-CONTEXT.md
@.planning/phases/02-interface-differentiation/02-RESEARCH.md
@pulsecraft_ui/shapeshifter.js
@pulsecraft_ui/style.css
@pulsecraft_ui/index.html
</context>

<tasks>

<task type="auto">
  <name>Task 1: Redesign mode switcher with color-coded options</name>
  <files>pulsecraft_ui/shapeshifter.js, pulsecraft_ui/style.css</files>
  <action>
**In style.css**, add enhanced mode switcher styles:

```css
/* Mode Switcher - Enhanced with color coding */
.mode-switcher {
    position: fixed;
    top: 1rem;
    right: 1rem;
    z-index: 100;
    background: rgba(15, 23, 42, 0.9);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1px solid rgba(148, 163, 184, 0.15);
    border-radius: 0.75rem;
    padding: 0.75rem 1rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.mode-switcher label {
    font-size: 0.7rem;
    color: #94a3b8;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 0.5rem;
    display: block;
}

.mode-switcher select {
    appearance: none;
    background: rgba(30, 41, 59, 0.8);
    border: 1px solid rgba(148, 163, 184, 0.2);
    border-radius: 0.5rem;
    padding: 0.5rem 2rem 0.5rem 0.75rem;
    font-size: 0.875rem;
    font-weight: 500;
    color: #f1f5f9;
    cursor: pointer;
    min-width: 140px;
    transition: all 0.2s ease;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2394a3b8' d='M2 4l4 4 4-4'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 0.75rem center;
}

.mode-switcher select:hover {
    border-color: var(--accent-primary);
    background-color: rgba(30, 41, 59, 1);
}

.mode-switcher select:focus {
    outline: none;
    border-color: var(--accent-primary);
    box-shadow: 0 0 0 2px var(--accent-glow);
}

/* Mode indicator dot */
.mode-switcher::after {
    content: '';
    position: absolute;
    top: 0.75rem;
    left: 0.75rem;
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--accent-primary);
    box-shadow: 0 0 8px var(--accent-glow);
}

/* Mode option colors when dropdown is open */
.mode-switcher select option {
    background: #1e293b;
    color: #f1f5f9;
    padding: 0.5rem;
}

.mode-switcher select option[value="branding"] {
    border-left: 3px solid #3b82f6;
}

.mode-switcher select option[value="author"] {
    border-left: 3px solid #ef4444;
}

.mode-switcher select option[value="therapy"] {
    border-left: 3px solid #10b981;
}
```

**In shapeshifter.js**, update `setupModeSwitcher()` to include icons and better structure:

```javascript
setupModeSwitcher() {
    // Don't show mode switcher on landing page
    if (this.mode === null) return;

    let switcher = document.getElementById('modeSwitcher');
    if (!switcher) {
        switcher = document.createElement('div');
        switcher.id = 'modeSwitcher';
        switcher.className = 'mode-switcher';
        switcher.innerHTML = `
            <label for="modeSelect">Interface</label>
            <select id="modeSelect">
                <option value="branding" data-icon="fingerprint">Branding</option>
                <option value="author" data-icon="feather-pointed">Author</option>
                <option value="therapy" data-icon="compass">Self-Reflection</option>
            </select>
        `;
        document.body.appendChild(switcher);
    }

    const modeSelect = document.getElementById('modeSelect');
    if (modeSelect) {
        // Set current mode
        modeSelect.value = this.mode;

        // Remove existing listener before adding new one
        const newSelect = modeSelect.cloneNode(true);
        modeSelect.parentNode.replaceChild(newSelect, modeSelect);
        newSelect.value = this.mode;

        newSelect.addEventListener('change', (e) => {
            const selectedMode = e.target.value;
            const pathMap = {
                'branding': '/branding',
                'author': '/author',
                'therapy': '/self-reflection'
            };

            const targetPath = pathMap[selectedMode];
            if (window.pulsecraftRouter && targetPath) {
                window.pulsecraftRouter.navigateTo(targetPath);
            }
        });
    }
}
```

WHY: Color-coded mode switcher helps users instantly recognize which interface they're in. The indicator dot uses the mode accent color for visual reinforcement.
  </action>
  <verify>
1. Navigate to /branding - verify blue indicator dot appears
2. Navigate to /author - verify red indicator dot appears
3. Navigate to /self-reflection - verify green indicator dot appears
4. Open dropdown - verify options are visible with professional styling
  </verify>
  <done>
Mode switcher has glassmorphism styling, color-coded indicator dot, and clear mode selection.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add empty state component for Voice Library</name>
  <files>pulsecraft_ui/index.html, pulsecraft_ui/style.css, pulsecraft_ui/shapeshifter.js</files>
  <action>
**In index.html**, add empty state container inside the library-preview section (Phase 3):

Find the `.library-preview` section and add an empty state div:

```html
<div class="section library-preview">
    <h3>Your Voice Library</h3>

    <!-- Empty state - shown when no kits exist -->
    <div id="libraryEmptyState" class="empty-state">
        <div class="empty-state-icon">
            <i class="fas fa-inbox"></i>
        </div>
        <h4 class="empty-state-title">No Voice Kits Yet</h4>
        <p class="empty-state-message">Create your first Voice Kit to unlock content generation.</p>
        <button class="btn-primary empty-state-cta" onclick="document.querySelector('.phase-1').scrollIntoView({behavior: 'smooth'})">
            Create First Voice Kit
        </button>
    </div>

    <!-- Existing library controls - hidden when empty -->
    <div id="libraryControls" class="library-controls">
        <select id="sessionSelect">
            <option value="" selected disabled>Select a saved voice</option>
        </select>
        <button class="btn-secondary" id="recallButton">Recall Voice</button>
    </div>
</div>
```

**In style.css**, add empty state styles:

```css
/* Empty State Component */
.empty-state {
    text-align: center;
    padding: 2.5rem 1.5rem;
    color: var(--color-text-secondary, #64748b);
}

.empty-state-icon {
    font-size: 2.5rem;
    color: var(--accent-primary, #6366f1);
    margin-bottom: 1rem;
    opacity: 0.6;
}

.empty-state-icon i {
    background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-hover) 100%);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
}

.empty-state-title {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--color-text-primary, #1e293b);
    margin-bottom: 0.5rem;
}

.empty-state-message {
    font-size: 0.9rem;
    line-height: 1.6;
    margin-bottom: 1.25rem;
    max-width: 280px;
    margin-left: auto;
    margin-right: auto;
}

.empty-state-cta {
    margin: 0 auto;
}

/* Hide empty state when library has items */
.library-has-items .empty-state {
    display: none;
}

.library-has-items .library-controls {
    display: block;
}

/* Show empty state when library is empty */
.library-preview:not(.library-has-items) .library-controls {
    display: none;
}
```

**In shapeshifter.js**, update `translateInterface()` to handle empty state text:

Add to the updates object:
```javascript
// Empty state
'#libraryEmptyState .empty-state-title': lang.emptyStateTitle,
'#libraryEmptyState .empty-state-message': lang.emptyStateMessage,
'#libraryEmptyState .empty-state-cta': lang.emptyStateCTA,
```

Also add logic to show/hide empty state based on saved kits (this may already exist in script.js, but we add the class toggle):

```javascript
/**
 * Update library empty state visibility
 */
updateLibraryEmptyState() {
    const savedKits = window.getSavedVoiceKits ? window.getSavedVoiceKits() : [];
    const librarySection = document.querySelector('.library-preview');

    if (librarySection) {
        if (savedKits.length > 0) {
            librarySection.classList.add('library-has-items');
        } else {
            librarySection.classList.remove('library-has-items');
        }
    }
}
```

Call this in `applyMode()` and export globally:
```javascript
// In applyMode(), after translateInterface:
this.updateLibraryEmptyState();

// Global export
window.updateLibraryEmptyState = () => window.pulsecraftShapeshifter?.updateLibraryEmptyState();
```

WHY: Empty states guide new users. Mode-specific messaging explains the value proposition per interface (brand consistency vs writing style vs personal voice).
  </action>
  <verify>
1. Clear localStorage to remove saved kits: `localStorage.clear(); location.reload()`
2. Navigate to /branding, unlock Phase 3 by analyzing + saving a kit, verify empty state shows "No Brand Kits Yet"
3. After saving a kit, verify empty state disappears and library controls appear
  </verify>
  <done>
Empty state appears when library is empty, shows mode-specific messaging, and hides when kits exist.
  </done>
</task>

<task type="auto">
  <name>Task 3: Add typography differentiation per mode</name>
  <files>pulsecraft_ui/style.css</files>
  <action>
Add mode-specific typography adjustments to style.css. Per CONTEXT.md:
- Branding: tighter/bold (professional)
- Author: relaxed/serif accents (creative)
- Self-Reflection: softer/rounded (supportive)

```css
/* Mode-specific Typography */

/* Branding: Professional, tighter, bold */
[data-mode="branding"] {
    --heading-weight: 700;
    --heading-spacing: -0.02em;
    --body-line-height: 1.5;
}

[data-mode="branding"] h1,
[data-mode="branding"] h2 {
    font-weight: var(--heading-weight);
    letter-spacing: var(--heading-spacing);
}

[data-mode="branding"] .tagline {
    font-style: normal;
    font-weight: 500;
}

/* Author: Creative, relaxed, serif accents */
[data-mode="author"] {
    --heading-weight: 600;
    --heading-spacing: -0.01em;
    --body-line-height: 1.7;
}

[data-mode="author"] h1,
[data-mode="author"] h2 {
    font-weight: var(--heading-weight);
    letter-spacing: var(--heading-spacing);
}

[data-mode="author"] .tagline,
[data-mode="author"] .mirror-instruction {
    font-family: Georgia, 'Times New Roman', serif;
    font-style: italic;
    line-height: 1.8;
}

[data-mode="author"] .voice-attribute span {
    font-family: Georgia, 'Times New Roman', serif;
    line-height: 1.7;
}

/* Self-Reflection: Supportive, softer, rounded */
[data-mode="therapy"] {
    --heading-weight: 500;
    --heading-spacing: 0;
    --body-line-height: 1.65;
}

[data-mode="therapy"] h1,
[data-mode="therapy"] h2 {
    font-weight: var(--heading-weight);
    letter-spacing: var(--heading-spacing);
}

[data-mode="therapy"] .mirror-instruction,
[data-mode="therapy"] .observatory-subtitle {
    font-size: 1.05em;
    line-height: 1.7;
}

[data-mode="therapy"] button {
    border-radius: 0.6rem;
}

/* Mode-specific placeholder text styling */
[data-mode="branding"] textarea::placeholder,
[data-mode="branding"] input::placeholder {
    font-weight: 400;
    color: #64748b;
}

[data-mode="author"] textarea::placeholder,
[data-mode="author"] input::placeholder {
    font-style: italic;
    color: #78716c;
}

[data-mode="therapy"] textarea::placeholder,
[data-mode="therapy"] input::placeholder {
    font-weight: 400;
    color: #6b7280;
}
```

WHY: Subtle typography differences reinforce mode identity without being jarring. Serif for Author mode evokes literary tradition. Rounded buttons in Self-Reflection feel more approachable.
  </action>
  <verify>
1. Navigate to /author - verify tagline text uses serif font (Georgia)
2. Navigate to /branding - verify headings are bolder with tighter letter-spacing
3. Navigate to /self-reflection - verify buttons have more rounded corners
  </verify>
  <done>
Each mode has subtle typography differences that reinforce its identity while maintaining readability.
  </done>
</task>

</tasks>

<verification>
1. Mode switcher shows color-coded indicator dot matching current mode accent
2. Dropdown opens smoothly with professional styling
3. Empty state shows mode-specific title, message, and CTA
4. Empty state disappears when user has saved kits
5. Typography feels distinct per mode (bold/tight for Branding, serif/relaxed for Author, soft/rounded for Self-Reflection)
6. Placeholder text adapts style per mode
</verification>

<success_criteria>
- Mode switcher displays indicator dot in mode accent color (blue/red/green)
- Empty state in Voice Library shows mode-appropriate welcome message
- Branding mode: Professional typography, tighter spacing, bold headings
- Author mode: Serif font accents on tagline and voice attributes, relaxed line height
- Self-Reflection mode: Softer headings, rounded buttons, supportive tone
- All three modes feel contextually appropriate and distinct
</success_criteria>

<output>
After completion, create `.planning/phases/02-interface-differentiation/02-04-SUMMARY.md`
</output>
